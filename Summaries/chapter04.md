# Node.js 교과서 4장 요약
## *http 모듈로 서버 만들기*
- - -

## 4.1 요청과 응답 이해하기

![Alt text](image.png)

서버는 클라이언트가 있기에 동작한다. 클라이언트는 서버로 **요청(request)** 을 보내고, 서버는 요청의 내용을 읽고 처리한 뒤 클라이언트에게 **응답(response)** 을 보낸다.

따라서 서버엔 요청을 받는 부분과 응답을 보내는 부분이 있어야 한다. 요청과 응답은 이벤트 방식으로 여겨질 수 있다. 클라이언트로부터 요청이 왔을 때 어떤 작업을 수행할지 이벤트 리스너를 미리 등록해 두어야 한다.

**createServer.js**
```
const http = require("http");

http.createServer((req, res) => {
    // 여기에 어떻게 응답할지 기술한다.
});
```

위 코드는 이벤트 리스너를 가진 노드 서버를 만들기 위한 템플릿 코드이다.

`http` 모듈을 사용하여 웹 브라우저의 요청을 처리할 수 있는 http 서버를 생성했다. `createServer` 메소드를 사용하여 인수로 요청에 대한 콜백 함수를 전달할 수 있으며, 요청이 들어올 때마다 매번 콜백 함수가 실행된다. 따라서 이 콜백 함수에 요청에 대한 응답을 기술하면 된다.

다음 예제로 응답을 보내는 부분과 서버 연결 부분을 추가한다.

**server1.js**
```
const http = require("http");

http.createServer((req, res) => {
    res.writeHead(200, { "Content-type": "text/html; charset=utf-8" });
    res.write("<h1>Hello Node!</h1>");
    res.end("<p>Hello Server!</p>");
})
    .listen(8080, () => {   // 서버 연결
        console.log("8080번 포트에서 서버 대기 중입니다.");
    });
```

**console**
```
PS D:\공부\Javascript\Study_Node.js\Codes\chapter04> node server1
8080번 포트에서 서버 대기 중입니다.
```

![Alt text](image-1.png)

브라우저를 실행하고 **http://localhost:8080/** 에 접속하면 위와 같은 화면이 나타난다. `Ctrl`+`C`를 입력하여 서버를 종료할 수 있다.

`createServer` 메소드 안에는 요청에 대한 응답을 정의하고, 메소드 뒤에는 `listen` 메소드를 붙여 그 안에 클라이언트에게 공개할 포트 번호와 포트 연결 후 실행될 콜백 함수를 전달한다. 프로그램을 실행하면 서버는 8080번 포트에서 요청을 기다린다.

`res` 객체에는 `res.writeHead`, `res.write`, `res.end` 메소드가 있다.

`res.writeHead`는 응답에 대한 정보를 기록하는 메소드이다. 첫 번째 인수로는 성공적인 요청임을 의미하는 `200`을, 두 번째 인수로는 응답에 대한 정보를 보낸다. 코드에서는 두 번째 인수에서 콘텐츠의 형식이 HTML임을 알리고 있다. 또한, 한글 표시를 위해 charset을 utf-8로 지정했다. 이러한 정보가 기록되는 부분을 `헤더(header)`라고 한다.

`res.write`의 첫 번째 인수는 클라이언트로 보낼 데이터이다. 예제에서는 HTML 모양의 문자열을 보냈지만 버퍼를 보낼 수도 있다. 또한, 여러 번 호출해서 데이터를 여러 개 보내도 된다. 데이터가 기록되는 부분을 `본문(body)`이라고 한다.

`res.end`는 응답을 종료한다. 만약 인수가 있다면 그 데이터까지 클라이언트로 보낸다. 브라우저는 응답 내용을 받아서 렌더링한다.

`listen` 메소드에 콜백 함수를 넣는 대신 다음 예제와 같이 서버에 `listening` 이벤트 리스너를 등록해도 된다. 추가로 `error` 이벤트 리스너도 등록하였다.

**server-1.js**
```

```